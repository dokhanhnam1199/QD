import numpy as np

def priority_v2(
    item: float,
    bins_remain_cap: np.ndarray,
    eps_fill: float = 2.54188315010983e-07,
    eps_residual: float = 9.106670408329566e-07,
    atol_perfection: float = 2.9406910948870618e-06,
    perfection_bonus_weight: float = 0.6209179433370653) -> np.ndarray:
    """Balances immediate tight packing (item/remaining_ratio) with future 
    flexibility (sqrt residual space), using geometric mean for synergy."""
    
    remaining_after = bins_remain_cap - item
    valid_mask = remaining_after >= 0
    
    fill_efficiency = item / (bins_remain_cap + eps_fill)
    residual_potential = np.sqrt(np.maximum(remaining_after, 0) + eps_residual)
    synergy_score = np.sqrt(fill_efficiency * residual_potential)
    perfection_bonus = np.isclose(remaining_after, 0, atol=atol_perfection) * perfection_bonus_weight
    scores = np.where(valid_mask, synergy_score + perfection_bonus, -np.inf)
    
    return scores
