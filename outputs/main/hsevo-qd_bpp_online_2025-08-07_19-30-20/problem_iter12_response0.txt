```python
import numpy as np

def priority_v2(item, bins_remain_cap):
    mask = bins_remain_cap >= item
    if not np.any(mask):
        return np.zeros_like(bins_remain_cap, dtype=int)
    residual = bins_remain_cap[mask] - item
    min_residual = residual.min()
    tied = np.flatnonzero(mask)[residual == min_residual]
    selected = np.random.choice(tied)
    out = np.zeros_like(bins_remain_cap, dtype=int)
    out[selected] = 1
    return out
```
