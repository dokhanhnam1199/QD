```python
import numpy as np

def priority_v2(item: float, bins_remain_cap: np.ndarray) -> np.ndarray:
    w = 0.1
    gamma = 0.5
    M = 1e6
    feasible = bins_remain_cap >= item
    residual = bins_remain_cap - item
    base = np.where(feasible, -residual**2 + w * bins_remain_cap + gamma / (1.0 + residual), -np.inf)
    exact = np.isclose(residual, 0.0)
    return base + np.where(exact, M, 0.0)
```
