```python
import numpy as np

def priority_v2(item: float, bins_remain_cap: np.ndarray) -> np.ndarray:
    """Combines best-fit (-residual^2) and worst-fit (remaining capacity) using a weighted sum, plus an exact-fit bonus. Deterministic, vectorized, no randomness."""
    feasible = bins_remain_cap >= item
    residual = bins_remain_cap - item
    w = 0.5
    base = np.where(feasible, -residual**2 + w * bins_remain_cap, -np.inf)
    exact = np.isclose(residual, 0.0)
    M = 1e9
    priorities = base + np.where(exact, M, 0.0)
    return priorities
```
