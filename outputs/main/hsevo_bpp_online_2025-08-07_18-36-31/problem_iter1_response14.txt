```python
import numpy as np
def priority_v2(item: float, bins_remain_cap: np.ndarray) -> np.ndarray:
    M = 1e9
    feasible = bins_remain_cap >= item
    residual = bins_remain_cap - item
    base = np.where(feasible, -residual, -np.inf)
    exact = np.isclose(residual, 0.0)
    priorities = base + np.where(exact, M, 0.0)
    return priorities
```
