import numpy as np

def heuristics_v2(distance_matrix):
  """{This algorithm samples multiple near-optimal TSP solutions using a greedy nearest neighbor heuristic with random restarts and incorporates edge costs into a heuristic matrix.}"""
  n = distance_matrix.shape[0]
  num_samples = 100

  edge_costs = np.zeros_like(distance_matrix, dtype=float)
  
  for _ in range(num_samples):
    start_node = np.random.randint(n)
    unvisited = set(range(n))
    unvisited.remove(start_node)
    current_node = start_node
    tour = [start_node]
    tour_length = 0
    
    while unvisited:
      nearest_neighbor = min(unvisited, key=lambda node: distance_matrix[current_node, node])
      tour_length += distance_matrix[current_node, nearest_neighbor]
      tour.append(nearest_neighbor)
      current_node = nearest_neighbor
      unvisited.remove(nearest_neighbor)
      
    tour_length += distance_matrix[current_node, start_node]
    
    for i in range(n):
        edge_costs[tour[i], tour[(i+1)%n]] += 1/tour_length
        edge_costs[tour[(i+1)%n], tour[i]] += 1/tour_length

  return heuristics_matrix
