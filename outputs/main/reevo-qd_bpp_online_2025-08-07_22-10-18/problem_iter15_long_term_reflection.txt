Scale leftovers by MAD, feed into a smooth sigmoid with steepness set by median residual. Add a tiny deterministic tie‑breaker. Boost exact fits, penalize waste proportionally. Use adaptive ε‑greedy (decaying), clip exponents, vectorise, avoid per‑call randomness and heavy normalisation. Handle zero spread.
