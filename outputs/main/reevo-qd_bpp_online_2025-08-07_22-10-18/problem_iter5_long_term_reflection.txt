Prioritize deterministic best‑fit: score each bin by negative leftover, boost exact fits. Mask infeasible bins (‑∞). Apply a sigmoid on leftover ratio, tuning steepness with median residuals; penalize waste exponentially, avoid zero division, weight by size. Normalize scores, tie‑break with epsilon or bin index; keep randomness minimal.
