```python
import numpy as np

def priority_v2(item: float, bins_remain_cap: np.ndarray) -> np.ndarray:
    """Combines capacity closeness with waste penalty and overflow avoidance."""

    diffs = bins_remain_cap - item
    priorities = 1.0 / (np.abs(diffs) + 0.000001)
    priorities[diffs < 0] = -1000.0
    priorities[diffs == 0] += 10.0
    waste_penalty = -np.abs(diffs)
    priorities = np.where(diffs >= 0, priorities + 0.1 * waste_penalty, priorities)
    return priorities
```
