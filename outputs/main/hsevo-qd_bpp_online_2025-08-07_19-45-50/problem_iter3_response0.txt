```python
import numpy as np

def priority_v2(item: float, bins_remain_cap: np.ndarray) -> np.ndarray:
    if bins_remain_cap.size == 0:
        return np.empty(0, dtype=float)
    cap = bins_remain_cap.max()
    mask = bins_remain_cap >= item
    left = bins_remain_cap - item
    best_fit = -left
    worst_fit = bins_remain_cap
    priorities = np.where(mask, np.where(item > 0.5 * cap, worst_fit, best_fit), -np.inf)
    return priorities
```
