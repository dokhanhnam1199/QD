```python
import numpy as np
from typing import Optional

def priority_v2(
    item: float,
    bins_remain_cap: np.ndarray,
    epsilon: float = 0.0,
    temperature: float = 1.0,
    random_state: Optional[int] = None,
) -> np.ndarray:
    """Blend waste‑based score, rank weighting, ε‑greedy perturbation, and temperature."""
    feasible = bins_remain_cap >= item
    scores = np.full_like(bins_remain_cap, -np.inf, dtype=float)
    if not np.any(feasible):
        return scores
    waste = bins_remain_cap[feasible] - item
    deterministic = -waste
    rng = np.random.default_rng(random_state)
    random_scores = rng.random(waste.shape)
    mixed = (1.0 - epsilon) * deterministic + epsilon * random_scores
    order = np.argsort(waste)
    ranks = np.empty_like(order)
    ranks[order] = np.arange(waste.size)
    mixed *= 1.0 / (ranks + 1.0)
    if temperature != 1.0:
        mixed = mixed / temperature
    scores[feasible] = mixed
    return scores
```
